{
    "id":  "/subscriptions/41de2c2e-1ec0-4d1b-b768-edd976cdd8fe/resourceGroups/dod365-law-rg2/providers/Microsoft.OperationalInsights/workspaces/dod365-law/providers/Microsoft.SecurityInsights/alertRules/9151ce3e-d740-4807-a9a5-ef2e74fd4e0e",
    "name":  "9151ce3e-d740-4807-a9a5-ef2e74fd4e0e",
    "etag":  "\"8700bc69-0000-2700-0000-66fdc2c20000\"",
    "type":  "Microsoft.SecurityInsights/alertRules",
    "kind":  "Scheduled",
    "properties":  {
                       "queryFrequency":  "PT1H",
                       "queryPeriod":  "PT1H",
                       "triggerOperator":  "GreaterThan",
                       "triggerThreshold":  0,
                       "severity":  "Medium",
                       "query":  "// Detects Key Vault operations that could be malicious\r\nlet operationlist = dynamic(\r\n    [\"VaultDelete\", \"KeyDelete\", \"SecretDelete\", \"SecretPurge\", \"KeyPurge\", \"SecretBackup\", \"KeyBackup\", \"SecretListDeleted\", \"CertificateCreate\", \"CertificatePurge\"]);\r\nAzureDiagnostics\r\n| where ResourceType == \"VAULTS\" and ResultType == \"Success\" \r\n| where OperationName in (operationlist)\r\n| project TimeGenerated,\r\n    ResourceGroup,\r\n    SubscriptionId,\r\n    KeyVaultName=Resource,\r\n    KeyVaultTarget=id_s,\r\n    Actor=identity_claim_upn_s,\r\n    IPAddressofActor=CallerIPAddress,\r\n    OperationName",
                       "suppressionDuration":  "PT5H",
                       "suppressionEnabled":  false,
                       "incidentConfiguration":  {
                                                     "createIncident":  true,
                                                     "groupingConfiguration":  {
                                                                                   "enabled":  false,
                                                                                   "reopenClosedIncident":  false,
                                                                                   "lookbackDuration":  "PT5H",
                                                                                   "matchingMethod":  "AllEntities",
                                                                                   "groupByEntities":  [

                                                                                                       ],
                                                                                   "groupByAlertDetails":  [

                                                                                                           ],
                                                                                   "groupByCustomDetails":  [

                                                                                                            ]
                                                                               }
                                                 },
                       "eventGroupingSettings":  {
                                                     "aggregationKind":  "SingleAlert"
                                                 },
                       "tactics":  [
                                       "CredentialAccess",
                                       "Exfiltration"
                                   ],
                       "techniques":  [
                                          "T1555"
                                      ],
                       "displayName":  "Detect Potential Malicious Operation in KeyVault",
                       "enabled":  true,
                       "description":  "Detects Key Vault operations that could be malicious.\nPLATFORM:IaaS,Windows\nMITRE:TA0006;T1552;T1552.001,TA0040;T1485;T1486",
                       "alertRuleTemplateName":  null,
                       "lastModifiedUtc":  "2024-10-02T22:01:38.0517806Z"
                   }
}
